{% extends 'base.html' %}
{% block title %}Search Patients{% endblock %}

{% block body %}
<div class="search-patient-div">
  <h2 id="search-patient-h2">Search Patients</h2>

  <form method="POST" class="search-button-form">
    <input type="text" name="query" placeholder="Name, National ID or MCH number" value="{{ query or '' }}">
    <button type="submit">Search</button>
  </form>

  {% if patients %}
    <table class="patient-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>National ID</th>
          <th>MCH Number</th>
          <th>Date of Birth</th>
          <th>Sex</th>
          <th>Record View</th>
        </tr>
      </thead>
      <tbody>
        {% for patient in patients %}
          <tr>
            <td>{{ patient.name }}</td>
            <td>{{ patient.national_id or '—' }}</td>
            <td>{{ patient.mch_number }}</td>
            <td>{{ patient.dob or '—' }}</td>
            <td>{{ patient.sex or '—' }}</td>
            <td>
              <a href="{{ url_for('patient_records', patient_id=patient.id) }}" target="_blank" class="view-button">
                View Records
              </a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% elif query %}
    <p>No patient records found for “{{ query }}”.</p>
  {% endif %}
</div>
{% endblock %}

